(window.webpackJsonp=window.webpackJsonp||[]).push([[50],{1124:function(t,e,s){"use strict";s.r(e);var n=s(1125),a=s.n(n);for(var i in n)["default"].indexOf(i)<0&&function(t){s.d(e,t,(function(){return n[t]}))}(i);e.default=a.a},1125:function(t,e,s){"use strict";e.__esModule=!0;var n=h(s(28)),a=s(198),i=h(s(1538)),o=h(s(736)),c=h(s(86)),r=s(751),l=h(s(740)),u=h(s(752)),p=h(s(735)),d=h(s(1347));function h(t){return t&&t.__esModule?t:{default:t}}e.default={name:"instance-list-index",data:function(){return{isLoading:!0,total:null,processInstanceList:[],searchParams:{searchVal:"",pageSize:10,pageNo:1,host:"",stateType:"",startDate:"",endDate:"",executorName:""},isLeft:!0}},props:{},methods:Object.assign({},(0,a.mapActions)("dag",["getProcessInstance"]),{_onQuery:function(t){this.searchParams.pageNo=1,this.searchParams=n.default.assign(this.searchParams,t),(0,r.setUrlParams)(this.searchParams),this._debounceGET()},_page:function(t){this.searchParams.pageNo=t,(0,r.setUrlParams)(this.searchParams),this._debounceGET()},_pageSize:function(t){this.searchParams.pageSize=t,(0,r.setUrlParams)(this.searchParams),this._debounceGET()},_getProcessInstanceListP:function(t){var e=this;this.isLoading=!t,this.getProcessInstance(this.searchParams).then((function(t){e.searchParams.pageNo>1&&0==t.totalList.length?e.searchParams.pageNo=e.searchParams.pageNo-1:(e.processInstanceList=[],e.processInstanceList=t.totalList,e.total=t.total,e.isLoading=!1)})).catch((function(t){e.isLoading=!1}))},_onUpdate:function(){this._debounceGET()},_routerView:function(){return"projects-instance-details"===this.$route.name},_debounceGET:n.default.debounce((function(t){0==sessionStorage.getItem("isLeft")?this.isLeft=!1:this.isLeft=!0,this._getProcessInstanceListP(t)}),100,{leading:!1,trailing:!0})}),watch:{$route:function(t,e){"instance"===t.name&&"projects-instance-details"===e.name?this._debounceGET():this.searchParams.pageNo=!n.default.isEmpty(t.query)&&t.query.pageNo||1},searchParams:{deep:!0,handler:function(){this._debounceGET()}}},created:function(){c.default.removeItem("subProcessId"),n.default.isEmpty(this.$route.query)||(this.searchParams=n.default.assign(this.searchParams,this.$route.query)),this._routerView()||this._debounceGET()},mounted:function(){var t=this;this.$modal.destroy(),this.setIntervalP=setInterval((function(){t._debounceGET("false")}),9e4)},beforeDestroy:function(){clearInterval(this.setIntervalP),sessionStorage.setItem("isLeft",1)},components:{mList:i.default,mInstanceConditions:d.default,mSpin:o.default,mListConstruction:p.default,mSecondaryMenu:u.default,mNoData:l.default}}},1126:function(t,e,s){"use strict";s.r(e);var n=s(1127),a=s.n(n);for(var i in n)["default"].indexOf(i)<0&&function(t){s.d(e,t,(function(){return n[t]}))}(i);e.default=a.a},1127:function(t,e,s){"use strict";(function(t){e.__esModule=!0;var n,a=s(28),i=(n=a)&&n.__esModule?n:{default:n},o=s(198),c=s(293);e.default={name:"list",data:function(){return{list:[],buttonType:"",strDelete:"",checkAll:!1}},props:{processInstanceList:Array,pageNo:Number,pageSize:Number},methods:Object.assign({},(0,o.mapActions)("dag",["editExecutorsState","deleteInstance","batchDeleteInstance"]),{_rtRunningType:function(t){return i.default.filter(c.runningType,(function(e){return e.code===t}))[0].desc},_rtState:function(t){var e=c.tasksState[t];return'<em class="ansfont '+e.icoUnicode+" "+(e.isSpin?"as as-spin":"")+'" style="color:'+e.color+'" data-toggle="tooltip" data-container="body" title="'+e.desc+'"></em>'},_closeDelete:function(t){t<0?this.$refs.poptipDeleteAll.doClose():this.$refs["poptip-delete-"+t][0].doClose()},_delete:function(t,e){var s=this;e<0?this._batchDelete():this.deleteInstance({processInstanceId:t.id}).then((function(t){s.$refs["poptip-delete-"+e][0].doClose(),s._onUpdate(),s.$message.success(t.msg)})).catch((function(t){s.$refs["poptip-delete-"+e][0].doClose(),s.$message.error(t.msg||"")}))},_reEdit:function(t){this.$router.push({path:"/projects/instance/list/"+t.id})},_reRun:function(t,e){this._countDownFn({id:t.id,executeType:"REPEAT_RUNNING",index:e,buttonType:"run"})},_restore:function(t,e){this._countDownFn({id:t.id,executeType:"START_FAILURE_TASK_PROCESS",index:e,buttonType:"store"})},_stop:function(t,e){"STOP"==t.state?this._countDownFn({id:t.id,executeType:"RECOVER_SUSPENDED_PROCESS",index:e,buttonType:"suspend"}):this._upExecutorsState({processInstanceId:t.id,executeType:"STOP"})},_suspend:function(t,e){"PAUSE"===t.state?this._countDownFn({id:t.id,executeType:"RECOVER_SUSPENDED_PROCESS",index:e,buttonType:"suspend"}):this._upExecutorsState({processInstanceId:t.id,executeType:"PAUSE"})},_upExecutorsState:function(e){var s=this;this.editExecutorsState(e).then((function(e){s.$message.success(e.msg),t("body").find(".tooltip.fade.top.in").remove(),s._onUpdate()})).catch((function(t){s.$message.error(t.msg||""),s._onUpdate()}))},_countDownFn:function(e){var s=this;this.buttonType=e.buttonType,this.editExecutorsState({processInstanceId:e.id,executeType:e.executeType}).then((function(n){s.list[e.index].disabled=!1,t("body").find(".tooltip.fade.top.in").remove(),s.$forceUpdate(),s.$message.success(n.msg),s._countDown((function(){s._onUpdate()}),e.index)})).catch((function(t){s.$message.error(t.msg||""),s._onUpdate()}))},_onUpdate:function(){this.$emit("on-update")},_listDataHandle:function(t){return t.length&&i.default.map(t,(function(t){t.disabled=!0,t.count=9})),t},_countDown:function(t,e){var s=this,n=void 0,a=void 0;n||(a=10,n=setInterval((function(){a>0&&a<=10?(a--,s.list[e].count=a,s.$forceUpdate()):(t(),clearInterval(n),n=null)}),1e3))},_gantt:function(t){this.$router.push({path:"/projects/instance/gantt/"+t.id})},_topCheckBoxClick:function(t){i.default.map(this.list,(function(e){return e.isCheck="RUNNING_EXECUTION"!==e.state&&"READY_STOP"!==e.state&&"READY_PAUSE"!==e.state&&t})),this._arrDelChange()},_arrDelChange:function(t){var e=[];this.list.forEach((function(t){t.isCheck&&e.push(t.id)})),this.strDelete=i.default.join(e,","),!1===t&&(this.checkAll=!1)},_batchDelete:function(){var t=this;this.$refs.poptipDeleteAll.doClose(),this.batchDeleteInstance({processInstanceIds:this.strDelete}).then((function(e){t._onUpdate(),t.checkAll=!1,t.strDelete="",t.$message.success(e.msg)})).catch((function(e){t.checkAll=!1,t.strDelete="",t.$message.error(e.msg||"")}))}}),watch:{processInstanceList:{handler:function(t){var e=this;this.checkAll=!1,this.list=[],setTimeout((function(){e.list=i.default.cloneDeep(e._listDataHandle(t))}))},immediate:!0,deep:!0},pageNo:function(){this.strDelete=""}},created:function(){},mounted:function(){},components:{}}}).call(this,s(17))},1348:function(t,e,s){},1538:function(t,e,s){"use strict";s.r(e);var n=s(1670),a=s(1126);for(var i in a)["default"].indexOf(i)<0&&function(t){s.d(e,t,(function(){return a[t]}))}(i);var o=s(7),c=Object(o.a)(a.default,n.a,n.b,!1,null,null,null);e.default=c.exports},1539:function(t,e,s){"use strict";s(1348)},1616:function(t,e,s){"use strict";s.d(e,"a",(function(){return n})),s.d(e,"b",(function(){return a}));var n=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"wrap-table"},[s("m-list-construction",{attrs:{title:t.$t("Process Instance")}},[s("template",{slot:"conditions"},[s("m-instance-conditions",{on:{"on-query":t._onQuery}})],1),t._v(" "),s("template",{slot:"content"},[t.processInstanceList.length||t.total>0?[s("m-list",{attrs:{"process-instance-list":t.processInstanceList,"page-no":t.searchParams.pageNo,"page-size":t.searchParams.pageSize},on:{"on-update":t._onUpdate}}),t._v(" "),s("div",{staticClass:"page-box"},[s("x-page",{attrs:{current:parseInt(t.searchParams.pageNo),total:t.total,"show-elevator":"","show-sizer":"","page-size-options":[10,30,50]},on:{"on-change":t._page,"on-size-change":t._pageSize}})],1)]:t._e(),t._v(" "),!t.processInstanceList.length&&t.total<=0?[s("m-no-data")]:t._e(),t._v(" "),s("m-spin",{attrs:{"is-spin":t.isLoading,"is-left":t.isLeft}})],2)],2)],1)},a=[]},1670:function(t,e,s){"use strict";s.d(e,"a",(function(){return n})),s.d(e,"b",(function(){return a}));var n=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"list-model",staticStyle:{position:"relative"}},[s("div",{staticClass:"table-box"},[s("table",{staticClass:"fixed"},[s("tr",[s("th",{staticStyle:{"min-width":"50px"},attrs:{scope:"col"}},[s("x-checkbox",{on:{"on-change":t._topCheckBoxClick},model:{value:t.checkAll,callback:function(e){t.checkAll=e},expression:"checkAll"}})],1),t._v(" "),s("th",{staticStyle:{"min-width":"30px"},attrs:{scope:"col"}},[s("span",[t._v(t._s(t.$t("#")))])]),t._v(" "),s("th",{staticStyle:{"min-width":"200px","max-width":"300px"},attrs:{scope:"col"}},[s("span",[t._v(t._s(t.$t("Process Name")))])]),t._v(" "),s("th",{staticStyle:{"min-width":"30px"},attrs:{scope:"col"}},[s("span",[t._v(t._s(t.$t("State")))])]),t._v(" "),s("th",{staticStyle:{"min-width":"70px"},attrs:{scope:"col"}},[s("span",[t._v(t._s(t.$t("Run Type")))])]),t._v(" "),s("th",{staticStyle:{"min-width":"130px"},attrs:{scope:"col"}},[s("span",[t._v(t._s(t.$t("Scheduling Time")))])]),t._v(" "),s("th",{staticStyle:{"min-width":"130px"},attrs:{scope:"col"}},[s("span",[t._v(t._s(t.$t("Start Time")))])]),t._v(" "),s("th",{staticStyle:{"min-width":"130px"},attrs:{scope:"col"}},[s("span",[t._v(t._s(t.$t("End Time")))])]),t._v(" "),s("th",{staticStyle:{"min-width":"60px"},attrs:{scope:"col"}},[s("span",[t._v(t._s(t.$t("Duration")))])]),t._v(" "),s("th",{staticStyle:{"min-width":"60px"},attrs:{scope:"col"}},[s("span",[t._v(t._s(t.$t("Run Times")))])]),t._v(" "),s("th",{staticStyle:{"min-width":"55px"},attrs:{scope:"col"}},[s("span",[t._v(t._s(t.$t("fault-tolerant sign")))])]),t._v(" "),s("th",{staticStyle:{"min-width":"135px"},attrs:{scope:"col"}},[s("span",[t._v(t._s(t.$t("Executor")))])]),t._v(" "),s("th",{staticStyle:{"min-width":"490px"},attrs:{scope:"col"}},[s("span",[t._v(t._s(t.$t("host")))])]),t._v(" "),s("th",{staticStyle:{"min-width":"230px"},attrs:{scope:"col"}},[s("span",[t._v(t._s(t.$t("Operation")))])])]),t._v(" "),t._l(t.list,(function(e,n){return s("tr",{key:e.id},[s("td",{attrs:{width:"50"}},[s("x-checkbox",{attrs:{disabled:"RUNNING_EXECUTION"===e.state||"READY_STOP"===e.state||"READY_PAUSE"===e.state},on:{"on-change":t._arrDelChange},model:{value:e.isCheck,callback:function(s){t.$set(e,"isCheck",s)},expression:"item.isCheck"}})],1),t._v(" "),s("td",{attrs:{width:"50"}},[s("span",[t._v(t._s(parseInt(1===t.pageNo?n+1:n+1+t.pageSize*(t.pageNo-1))))])]),t._v(" "),s("td",{staticStyle:{"min-width":"200px","max-width":"300px","padding-right":"10px"}},[s("span",{staticClass:"ellipsis",staticStyle:{"padding-left":"4px"}},[s("router-link",{staticClass:"links",attrs:{to:{path:"/projects/instance/list/"+e.id,query:{id:e.processDefinitionId}},tag:"a",title:e.name}},[t._v(t._s(e.name))])],1)]),t._v(" "),s("td",[s("span",{staticStyle:{cursor:"pointer"},domProps:{innerHTML:t._s(t._rtState(e.state))}})]),t._v(" "),s("td",[s("span",[t._v(t._s(t._rtRunningType(e.commandType)))])]),t._v(" "),s("td",[e.scheduleTime?s("span",[t._v(t._s(t._f("formatDate")(e.scheduleTime)))]):s("span",[t._v("-")])]),t._v(" "),s("td",[e.startTime?s("span",[t._v(t._s(t._f("formatDate")(e.startTime)))]):s("span",[t._v("-")])]),t._v(" "),s("td",[e.endTime?s("span",[t._v(t._s(t._f("formatDate")(e.endTime)))]):s("span",[t._v("-")])]),t._v(" "),s("td",{attrs:{width:"70"}},[s("span",[t._v(t._s(e.duration||"-"))])]),t._v(" "),s("td",{attrs:{width:"70"}},[s("span",[t._v(t._s(e.runTimes))])]),t._v(" "),s("td",[s("span",[t._v(t._s(e.recovery))])]),t._v(" "),s("td",[e.executorName?s("span",[t._v(t._s(e.executorName))]):s("span",[t._v("-")])]),t._v(" "),s("td",{staticStyle:{"min-width":"490px"}},[s("span",{staticStyle:{"padding-right":"10px"}},[t._v(t._s(e.host||"-"))])]),t._v(" "),s("td",{staticStyle:{"z-index":"inherit"}},[s("div",{directives:[{name:"show",rawName:"v-show",value:e.disabled,expression:"item.disabled"}]},[s("x-button",{attrs:{type:"info",shape:"circle",size:"xsmall","data-toggle":"tooltip",title:t.$t("Edit"),icon:"ans-icon-edit",disabled:"SUCCESS"!==e.state&&"PAUSE"!==e.state&&"FAILURE"!==e.state&&"STOP"!==e.state},on:{click:function(s){return t._reEdit(e)}}}),t._v(" "),s("x-button",{attrs:{type:"info",shape:"circle",size:"xsmall","data-toggle":"tooltip",title:t.$t("Rerun"),icon:"ans-icon-refresh",disabled:"SUCCESS"!==e.state&&"PAUSE"!==e.state&&"FAILURE"!==e.state&&"STOP"!==e.state},on:{click:function(s){return t._reRun(e,n)}}}),t._v(" "),s("x-button",{attrs:{type:"success",shape:"circle",size:"xsmall","data-toggle":"tooltip",title:t.$t("Recovery Failed"),icon:"ans-icon-fail-empty",disabled:"FAILURE"!==e.state},on:{click:function(s){return t._restore(e,n)}}}),t._v(" "),s("x-button",{attrs:{type:"error",shape:"circle",size:"xsmall","data-toggle":"tooltip",title:"STOP"===e.state?t.$t("Recovery Suspend"):t.$t("Stop"),icon:"STOP"===e.state?"ans-icon-pause-solid":"ans-icon-stop",disabled:"RUNNING_EXECUTION"!==e.state&&"STOP"!=e.state},on:{click:function(s){return t._stop(e,n)}}}),t._v(" "),s("x-button",{attrs:{type:"warning",shape:"circle",size:"xsmall","data-toggle":"tooltip",title:"PAUSE"===e.state?t.$t("Recovery Suspend"):t.$t("Pause"),icon:"PAUSE"===e.state?"ans-icon-pause-solid":"ans-icon-pause",disabled:"RUNNING_EXECUTION"!==e.state&&"PAUSE"!==e.state},on:{click:function(s){return t._suspend(e,n)}}}),t._v(" "),s("x-poptip",{ref:"poptip-delete-"+n,refInFor:!0,attrs:{placement:"top-end",width:"90"}},[s("p",[t._v(t._s(t.$t("Delete?")))]),t._v(" "),s("div",{staticStyle:{"text-align":"right",margin:"0","padding-top":"4px"}},[s("x-button",{attrs:{type:"text",size:"xsmall",shape:"circle"},on:{click:function(e){return t._closeDelete(n)}}},[t._v(t._s(t.$t("Cancel")))]),t._v(" "),s("x-button",{attrs:{type:"primary",size:"xsmall",shape:"circle"},on:{click:function(s){return t._delete(e,n)}}},[t._v(t._s(t.$t("Confirm")))])],1),t._v(" "),s("template",{slot:"reference"},[s("x-button",{attrs:{icon:"ans-icon-trash",type:"error",shape:"circle",size:"xsmall","data-toggle":"tooltip",disabled:"SUCCESS"!==e.state&&"FAILURE"!==e.state&&"STOP"!==e.state&&"PAUSE"!==e.state,title:t.$t("delete")}})],1)],2),t._v(" "),s("x-button",{attrs:{type:"info",shape:"circle",size:"xsmall","data-toggle":"tooltip",title:t.$t("Gantt"),icon:"ans-icon-gantt"},on:{click:function(s){return t._gantt(e)}}})],1),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:!e.disabled,expression:"!item.disabled"}]},[s("x-button",{attrs:{type:"info",shape:"circle",size:"xsmall",icon:"ans-icon-edit",disabled:"true"}}),t._v(" "),s("x-button",{directives:[{name:"show",rawName:"v-show",value:"run"===t.buttonType,expression:"buttonType === 'run'"}],attrs:{type:"info",shape:"circle",size:"xsmall",disabled:"true"}},[t._v("\n              "+t._s(e.count)+"\n            ")]),t._v(" "),s("x-button",{directives:[{name:"show",rawName:"v-show",value:"run"!==t.buttonType,expression:"buttonType !== 'run'"}],attrs:{type:"info",shape:"circle",size:"xsmall",icon:"ans-icon-refresh",disabled:"true"}}),t._v(" "),s("x-button",{directives:[{name:"show",rawName:"v-show",value:"store"===t.buttonType,expression:"buttonType === 'store'"}],attrs:{type:"success",shape:"circle",size:"xsmall",disabled:"true"}},[t._v("\n              "+t._s(e.count)+"\n            ")]),t._v(" "),s("x-button",{directives:[{name:"show",rawName:"v-show",value:"store"!==t.buttonType,expression:"buttonType !== 'store'"}],attrs:{type:"success",shape:"circle",size:"xsmall",icon:"ans-icon-fail-empty",disabled:"true"}}),t._v(" "),s("x-button",{directives:[{name:"show",rawName:"v-show",value:("PAUSE"===e.state||"STOP"==e.state)&&"suspend"===t.buttonType,expression:"(item.state === 'PAUSE' || item.state == 'STOP') && buttonType === 'suspend'"}],attrs:{type:"warning",shape:"circle",size:"xsmall",disabled:"true"}},[t._v("\n              "+t._s(e.count)+"\n            ")]),t._v(" "),s("x-button",{directives:[{name:"show",rawName:"v-show",value:("PAUSE"===e.state||"STOP"==e.state)&&"suspend"!==t.buttonType,expression:"(item.state === 'PAUSE' || item.state == 'STOP') && buttonType !== 'suspend'"}],attrs:{type:"warning",shape:"circle",size:"xsmall",icon:"ans-icon-pause-solid",disabled:"true"}}),t._v(" "),s("x-button",{directives:[{name:"show",rawName:"v-show",value:"PAUSE"!==e.state,expression:"item.state !== 'PAUSE'"}],attrs:{type:"warning",shape:"circle",size:"xsmall",icon:"ans-icon-stop",disabled:"true"}}),t._v(" "),s("x-button",{directives:[{name:"show",rawName:"v-show",value:"STOP"!==e.state,expression:"item.state !== 'STOP'"}],attrs:{type:"warning",shape:"circle",size:"xsmall",icon:"ans-icon-pause",disabled:"true"}}),t._v(" "),s("x-button",{attrs:{type:"error",shape:"circle",size:"xsmall",icon:"ans-icon-trash",disabled:!0}}),t._v(" "),s("x-button",{attrs:{type:"info",shape:"circle",size:"xsmall",icon:"ans-icon-gantt",disabled:"true"}})],1)])])}))],2)]),t._v(" "),s("x-poptip",{directives:[{name:"show",rawName:"v-show",value:""!==t.strDelete,expression:"strDelete !== ''"}],ref:"poptipDeleteAll",attrs:{placement:"bottom-start",width:"90"}},[s("p",[t._v(t._s(t.$t("Delete?")))]),t._v(" "),s("div",{staticStyle:{"text-align":"right",margin:"0","padding-top":"4px"}},[s("x-button",{attrs:{type:"text",size:"xsmall",shape:"circle"},on:{click:function(e){return t._closeDelete(-1)}}},[t._v(t._s(t.$t("Cancel")))]),t._v(" "),s("x-button",{attrs:{type:"primary",size:"xsmall",shape:"circle"},on:{click:function(e){return t._delete({},-1)}}},[t._v(t._s(t.$t("Confirm")))])],1),t._v(" "),s("template",{slot:"reference"},[s("x-button",{staticStyle:{position:"absolute",bottom:"-48px",left:"22px"},attrs:{size:"xsmall"}},[t._v(t._s(t.$t("Delete")))])],1)],2)],1)},a=[]},682:function(t,e,s){"use strict";s.r(e);var n=s(1616),a=s(1124);for(var i in a)["default"].indexOf(i)<0&&function(t){s.d(e,t,(function(){return a[t]}))}(i);s(1539);var o=s(7),c=Object(o.a)(a.default,n.a,n.b,!1,null,null,null);e.default=c.exports}}]);